(self.webpackChunk=self.webpackChunk||[]).push([[424],{55041:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return Pe}});var o=t(59312),n=t(74512),i=t(97979),a=t(47177),r=t(94013),d=t(73723),l=t(11942),c=t(32735);var v=c.forwardRef(((e,s)=>{const[t,o]=(0,c.useState)(!1),[v,u]=(0,c.useState)("");(0,c.useImperativeHandle)(s,(()=>({open:e=>{u(e),o(!0)}})),[]);const x=()=>o(!1);return(0,n.jsxs)(a.Z,Object.assign({open:t,onClose:x},{children:[(0,n.jsx)(r.Z,Object.assign({style:{padding:"20 30px",minWidth:"300px"}},{children:(0,n.jsxs)("p",{children:[(0,n.jsx)(i.Z,{color:"primary",fontSize:"large",style:{verticalAlign:"middle"}},void 0),(0,n.jsxs)("span",Object.assign({style:{verticalAlign:"middle",fontSize:20}},{children:[" ",v," "]}),void 0)]},void 0)}),void 0),(0,n.jsx)(d.Z,{children:(0,n.jsx)(l.Z,Object.assign({variant:"contained",onClick:x},{children:"Finish"}),void 0)},void 0)]}),void 0)})),u=t(3070),x=t(57816),g=t(62407),h=t(46881),m=t(94253),j=t(25371);var p=({loading:e,text:s})=>(0,n.jsxs)(m.Z,Object.assign({sx:{color:"#fff",display:"flex",flexDirection:"column",zIndex:e=>e.zIndex.drawer+1},open:e},{children:[s,(0,n.jsx)(j.Z,{color:"inherit",sx:{marginTop:2}},void 0)]}),void 0),f=t(31940);var b=()=>{const{enqueueSnackbar:e}=(0,f.Ds)();return(s,t="error")=>{e(s,{variant:t})}},Z=t(43424),y=t(54837),C=t(89541),S=t(68669),w=t(64141),O=t(21109),k=t(1011),I=t(82919),G=t(9459),P=t(91969),H=t.n(P),W=t(71157),R=t(51602),M=t(53760),F=t(49764);var T=({address:e,onClose:s})=>(0,n.jsxs)(a.Z,Object.assign({"aria-label":"close",open:!0,maxWidth:"sm"},{children:[(0,n.jsxs)(R.Z,{children:["Address",(0,n.jsx)(M.Z,Object.assign({"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]}},{children:(0,n.jsx)(W.Z,{},void 0)}),void 0)]},void 0),(0,n.jsxs)(r.Z,Object.assign({sx:{display:"flex",flexDirection:"column",alignItems:"center"}},{children:[(0,n.jsx)(F.tv,{value:`${e}`,size:300},void 0),(0,n.jsx)(h.Z,Object.assign({sx:{marginTop:2}},{children:e}),void 0)]}),void 0)]}),void 0),z=t(66888);const B="npm:@safeheron/mpcsnap",{ethereum:$}=window;function A(e){return(0,o.mG)(this,void 0,void 0,(function*(){console.log("walletInvokeSnap",e);try{return yield null==$?void 0:$.request({method:"wallet_invokeSnap",params:[B,e]})}catch(e){return{success:!1,errMsg:(null==e?void 0:e.message)||"Unknown snap error"}}}))}var D=t(8761),E=t(75693),K=t(98749),N=t(76175),q=t(23512);const U=window.ethereum?new q.Q(window.ethereum):null;var _=({address:e,balance:s,network:t,onDelete:i,onExport:a})=>{const[r,d]=(0,c.useState)(!1),[v,u]=(0,c.useState)(!1),x=b();return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p,{loading:r},void 0),(0,n.jsxs)(w.Z,Object.assign({variant:"outlined"},{children:[(0,n.jsx)(O.Z,{title:"Address",action:(0,n.jsx)(k.Z,{children:t.name},void 0)},void 0),(0,n.jsxs)(I.Z,{children:[(0,n.jsxs)(G.ZP,Object.assign({container:!0,direction:"row",justifyContent:"space-between",alignItems:"center"},{children:[(0,n.jsxs)(h.Z,Object.assign({sx:{display:"flex",alignItems:"center"}},{children:[(0,n.jsx)("span",{children:e||"0x......"},void 0),!!e&&(0,n.jsxs)(n.Fragment,{children:[" ",(0,n.jsx)(C.Z,{onClick:()=>{H()(e),x("Address has been copied!","success")},sx:{cursor:"pointer"}},void 0)," ",(0,n.jsx)(Z.Z,{onClick:()=>u(!0),sx:{cursor:"pointer"}},void 0)]},void 0),v&&(0,n.jsx)(T,{address:e,onClose:()=>u(!1)},void 0)]}),void 0),(0,n.jsxs)("div",{children:[(0,n.jsx)(l.Z,Object.assign({onClick:a},{children:(0,n.jsx)(y.Z,{},void 0)}),void 0),(0,n.jsx)(l.Z,Object.assign({onClick:()=>(0,o.mG)(void 0,void 0,void 0,(function*(){d(!0);const e=yield function(){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.deleteWallet})}))}();d(!1),e.success&&i()}))},{children:(0,n.jsx)(S.Z,{},void 0)}),void 0)]},void 0)]}),void 0),(0,n.jsxs)(k.Z,Object.assign({style:{fontSize:"18px"},fontWeight:"bold"},{children:[s?(g=s,(+E.dF(g)).toFixed(4)):0," ETH"]}),void 0)]},void 0)]}),void 0)]},void 0);var g};var Q=({onCreate:e,onImport:s,startHeartBeat:t,stopHeartBeat:i})=>{const[a,r]=(0,c.useState)(!1),d=b();return(0,n.jsxs)(m.Z,Object.assign({sx:{bgcolor:"rgba(255,255,255,0.7)",zIndex:e=>e.zIndex.drawer+1},open:!0},{children:[(0,n.jsx)(p,{loading:a,text:"Creating...(～30 seconds)"},void 0),(0,n.jsxs)(G.ZP,Object.assign({container:!0,justifyContent:"center",direction:"row",alignItems:"center"},{children:[(0,n.jsx)(l.Z,Object.assign({variant:"contained",onClick:()=>(0,o.mG)(void 0,void 0,void 0,(function*(){t(),r(!0);const s=yield function(){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.createWalletContext})}))}();r(!1),(null==s?void 0:s.success)?e():(d(s.errMsg),i())}))},{children:"Create MPC Wallet"}),void 0),(0,n.jsx)(h.Z,{mx:"20px"},void 0),(0,n.jsx)(l.Z,Object.assign({variant:"contained",onClick:s},{children:"Import MPC Wallet"}),void 0)]}),void 0)]}),void 0)},J=t(64350);var L=t(75291).Buffer;var V=({step:e,message:s,encodings:t="utf-8"})=>{const[o,i]=(0,c.useState)(""),a=(0,c.useRef)();(0,c.useEffect)((()=>(r(),()=>clearInterval(a.current))),[e]);const r=()=>{if(!s)return;const e=L.from(s,t),o=J.UR.fromBuffer(e),n=new J.UREncoder(o,400,0,10);clearInterval(a.current),a.current=setInterval((()=>{const e=n.nextPart();d(e)}),300)},d=e=>{i(e)};return(0,n.jsxs)(h.Z,Object.assign({sx:{display:"flex",marginRight:2,position:"relative"}},{children:[!o&&(0,n.jsx)(h.Z,Object.assign({sx:{position:"absolute",backgroundColor:"rgba(255,255,255,0.8)",width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center"}},{children:(0,n.jsx)(j.Z,{},void 0)}),void 0),(0,n.jsx)(F.tv,{value:`${o}`,size:400},void 0)]}),void 0)},Y=t(27896);const X=new Y.Nm;var ee=({step:e,onComplete:s})=>{const[t,i]=(0,c.useState)(""),[a,r]=(0,c.useState)(0),d=(0,c.useRef)(null),l=(0,c.useRef)();(0,c.useEffect)((()=>(Y.Nm.listVideoInputDevices().then((e=>{i(e[0].deviceId)})),v(),()=>{u()})),[]),(0,c.useEffect)((()=>{r(0)}),[e]);const v=()=>(0,o.mG)(void 0,void 0,void 0,(function*(){if(!d.current)return;const e=new J.URDecoder;l.current=yield X.decodeFromVideoDevice(t,d.current,((t,o)=>{const n=e.getProgress();if(n>a&&r(n),e.isComplete())if(e.isSuccess()){const t=e.resultUR().decodeCBOR();s(t.toString()),u()}else{const s=e.resultError();console.log("decode error====",s),u()}else(null==t?void 0:t.getText())&&e.receivePart(null==t?void 0:t.getText())}))})),u=()=>{var e;null===(e=l.current)||void 0===e||e.stop()};return(0,n.jsxs)(h.Z,{children:[(0,n.jsx)("video",{ref:d,id:"videoRef",width:"430",height:"400",style:{border:"1px solid rgba(0, 0, 0, 0.12)",filter:"blur(12px)"}},void 0),a>0&&a<1&&(0,n.jsxs)("div",{children:["Progress: ",(100*a).toFixed(0),"%"]},void 0)]},void 0)};const se=["Place the Keystone’s QR code in front of your camera.","Scan the QR code with your Keystone, and then place the Keystone’s QR code in front of your camera.","Scan the QR code with your Keystone, and then place the Keystone’s QR code in front of your camera."];var te=({onClose:e,onComplete:s})=>{const[t,i]=(0,c.useState)(!1),[v,u]=(0,c.useState)(""),[x,g]=(0,c.useState)(1),[m,j]=(0,c.useState)({});return(0,n.jsxs)(a.Z,Object.assign({open:!0,maxWidth:"md"},{children:[(0,n.jsx)(p,{loading:t},void 0),(0,n.jsxs)(R.Z,{children:["Step"," ",(0,n.jsx)("span",Object.assign({style:{fontSize:30,fontWeight:"bold",color:"#12B89A"}},{children:x}),void 0)," ","of 3:",se[x-1]]},void 0),(0,n.jsxs)(r.Z,{children:[1===x&&(0,n.jsxs)(h.Z,Object.assign({sx:{display:"flex"}},{children:[(0,n.jsx)(V,{step:1,message:""},void 0),(0,n.jsx)(ee,{step:1,onComplete:e=>(0,o.mG)(void 0,void 0,void 0,(function*(){console.log("step1 end"),i(!0);const s=yield function(e){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.createWalletStep1,params:{publicKey:e}})}))}(e);i(!1),console.log(s),s.success&&(console.log("message1:",`${s.message1}`),localStorage.setItem("authPubOfP1",`${s.publicKey}`),j({message1:`${s.message1}`,pubkey1:`${s.publicKey}`}),g(2))}))},void 0)]}),void 0),2===x&&(0,n.jsxs)(h.Z,Object.assign({sx:{display:"flex"}},{children:[(0,n.jsx)(V,{step:2,message:JSON.stringify(m)},void 0),(0,n.jsx)(ee,{step:2,onComplete:e=>(0,o.mG)(void 0,void 0,void 0,(function*(){console.log("step2 end"),console.log("message1",m.message1),i(!0);const s=yield function(e){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.createWalletStep2,params:{message2:e}})}))}(e);console.log(s),i(!1),s.success&&s.message3&&(console.log("message3:",s.message3),u(s.message3),g(3))}))},void 0)]}),void 0),3===x&&(0,n.jsxs)(h.Z,Object.assign({sx:{display:"flex"}},{children:[(0,n.jsx)(V,{step:3,message:v,encodings:"base64"},void 0),(0,n.jsx)(ee,{step:3,onComplete:e=>(0,o.mG)(void 0,void 0,void 0,(function*(){console.log("step3 end"),i(!0);const t=yield function(e){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.createWalletStep3,params:{message:e}})}))}(e);console.log(t),i(!1),t.success&&s(t.address)}))},void 0)]}),void 0)]},void 0),(0,n.jsx)(d.Z,{children:(0,n.jsx)(l.Z,Object.assign({variant:"outlined",onClick:e},{children:"Cancel"}),void 0)},void 0)]}),void 0)},oe=t(74494),ne=t(23626),ie=t(93988);const ae=/[A-Z]/,re=/[a-z]/;var de=({onClose:e,onComplete:s})=>{const t=b(),[i,v]=(0,c.useState)(!1),[u,x]=(0,c.useState)(""),[g,m]=(0,c.useState)(""),j=(0,c.useCallback)((e=>{x(e.target.value)}),[x]),f=(0,c.useCallback)((e=>{m(e.target.value)}),[m]),Z=e=>{const s=new Blob([e]),t=new FileReader;t.onloadend=()=>{var e;const s=document.createElement("a");s.href=t.result,s.style.display="none",s.download="mpc_keystroe.json",document.body.appendChild(s),s.click(),null===(e=s.parentNode)||void 0===e||e.removeChild(s)},t.readAsDataURL(s)};return(0,n.jsxs)(a.Z,Object.assign({open:!0,maxWidth:"sm"},{children:[(0,n.jsx)(p,{loading:i},void 0),(0,n.jsx)(R.Z,{children:"Export MPC Wallet"},void 0),(0,n.jsxs)(r.Z,{children:[(0,n.jsxs)(oe.Z,{children:[(0,n.jsx)(ne.Z,{children:"Enter a password to encrypt your MPC key shard"},void 0),(0,n.jsx)(ie.Z,{size:"small",placeholder:"Please enter your password",type:"password",value:u,onChange:j},void 0)]},void 0),(0,n.jsx)(h.Z,{my:"20px"},void 0),(0,n.jsxs)(oe.Z,{children:[(0,n.jsx)(ne.Z,{children:"Must contain at least 10 characters and include upper and lower case letters and digits. Symbols are allowed. Case sensitive."},void 0),(0,n.jsx)(ie.Z,{size:"small",placeholder:"Confirm password",type:"password",value:g,onChange:f},void 0)]},void 0),(0,n.jsx)(h.Z,{my:"20px"},void 0)]},void 0),(0,n.jsxs)(d.Z,Object.assign({sx:{padding:2}},{children:[(0,n.jsx)(l.Z,Object.assign({variant:"outlined",onClick:e},{children:"Cancel"}),void 0),(0,n.jsx)(l.Z,Object.assign({variant:"contained",onClick:()=>(0,o.mG)(void 0,void 0,void 0,(function*(){if(!u)return t("Password is Required");if(!(e=>{const s=e.length>=10,t=ae.test(e),o=re.test(e),n=/\d/.test(e);return s&&t&&o&&n})(u))return t("Must contain at least 10 characters and include upper and lower case letters and digits.");if(u!==g)return t("The password entered twice must be the same");v(!0);const n=yield function(e){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.exportWalletKeyShard,params:{password:e}})}))}(u);v(!1),console.log(n),n.success&&n.keystore?(e(),s(),Z(n.keystore)):t(n.errMsg)}))},{children:"Export"}),void 0)]}),void 0)]}),void 0)};var le=({connected:e,onConnect:s})=>(0,n.jsxs)(G.ZP,Object.assign({container:!0,direction:"row",justifyContent:"space-between",alignItems:"center"},{children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("div",Object.assign({style:{fontSize:"20px",fontWeight:"bold"}},{children:"MPCSnap"}),void 0),(0,n.jsx)("div",Object.assign({style:{fontSize:"14px"}},{children:"MPCSnap enables MPC Wallet inside MetaMask"}),void 0)]},void 0),(0,n.jsx)(l.Z,Object.assign({disabled:e,variant:"contained",color:"primary",onClick:s},{children:e?"Connected":"Connect Metamask Flask"}),void 0)]}),void 0);const ce=(0,t(12709).ZP)("input")({display:"none"});var ve=({onClose:e,onComplete:s})=>{const t=(0,c.useRef)(null),[i,v]=(0,c.useState)(""),[u,x]=(0,c.useState)(!1),[g,m]=(0,c.useState)(""),[j,f]=(0,c.useState)(""),Z=b();return(0,n.jsxs)(a.Z,Object.assign({open:!0,maxWidth:"sm"},{children:[(0,n.jsx)(p,{loading:u},void 0),(0,n.jsx)(R.Z,{children:"Import MPC Wallet"},void 0),(0,n.jsxs)(r.Z,Object.assign({sx:{width:500}},{children:[(0,n.jsxs)("label",Object.assign({htmlFor:"contained-button-file"},{children:[(0,n.jsx)(ce,{ref:t,onChange:e=>{var s;if(!(null===(s=e.target.files)||void 0===s?void 0:s.length))return;const o=e.target.files[0];v(o.name);const n=new FileReader;n.onload=()=>{m(`${n.result}`),t.current.value=""},n.readAsText(o)},id:"contained-button-file",multiple:!0,type:"file"},void 0),(0,n.jsx)(l.Z,Object.assign({variant:"contained",component:"span"},{children:"Choose Keystore file"}),void 0),(0,n.jsx)("span",Object.assign({style:{marginLeft:10}},{children:i}),void 0)]}),void 0),(0,n.jsx)(h.Z,{my:"20px"},void 0),(0,n.jsxs)(oe.Z,{children:[(0,n.jsx)(ne.Z,{children:"Password"},void 0),(0,n.jsx)(ie.Z,{onChange:e=>{f(e.target.value)},size:"small",placeholder:"Confirm password",type:"password"},void 0)]},void 0)]}),void 0),(0,n.jsxs)(d.Z,{children:[(0,n.jsx)(l.Z,Object.assign({variant:"outlined",onClick:e},{children:"Cancel"}),void 0),(0,n.jsx)(l.Z,Object.assign({variant:"contained",onClick:()=>(0,o.mG)(void 0,void 0,void 0,(function*(){if(!g)return Z("Please choose Keystore files");if(!j)return Z("Please enter password");console.log({keystore:g,password:j}),x(!0);const e=yield function(e,s){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.importWalletKeyshard,params:{keystore:e,password:s}})}))}(g,j);x(!1),e.success&&e.address?s(e.address):Z(e.errMsg)}))},{children:"Import"}),void 0)]},void 0)]}),void 0)},ue=t(71413),xe=t(98767),ge=t(77239),he=t(94313),me=t(21903),je=t(46970),pe=t(72587);var fe=({list:e,explorer:s})=>(0,n.jsxs)(w.Z,Object.assign({variant:"outlined"},{children:[(0,n.jsx)(O.Z,{title:"Transactions"},void 0),(0,n.jsx)(ue.Z,Object.assign({component:xe.Z},{children:(0,n.jsxs)(ge.Z,Object.assign({sx:{minWidth:650},"aria-label":"simple table"},{children:[(0,n.jsx)(he.Z,{children:(0,n.jsx)(me.Z,{children:(0,n.jsx)(je.Z,{children:"Tx Hash"},void 0)},void 0)},void 0),(0,n.jsx)(pe.Z,{children:e.map((e=>(0,n.jsx)(me.Z,Object.assign({sx:{"&:last-child td, &:last-child th":{border:0}}},{children:(0,n.jsx)(je.Z,Object.assign({component:"th",scope:"row"},{children:s?(0,n.jsx)(x.Z,Object.assign({target:"_blank",href:`${s}/tx/${e.txHash}`},{children:e.txHash}),void 0):e.txHash}),void 0)}),e.txHash)))},void 0)]}),void 0)}),void 0)]}),void 0),be=t(36201),Ze=t(2237);var ye=({qrcode1:e,onClose:s,onComplete:t})=>{const[i,v]=(0,c.useState)(!1),[u,x]=(0,c.useState)(""),[g,m]=(0,c.useState)(1),j=b();return(0,n.jsxs)(a.Z,Object.assign({open:!0,maxWidth:"md"},{children:[(0,n.jsx)(p,{loading:i},void 0),(0,n.jsxs)(R.Z,{children:["Step"," ",(0,n.jsx)("span",Object.assign({style:{fontSize:30,fontWeight:"bold",color:"#12B89A"}},{children:g}),void 0)," ","of 2: Scan the QR code with your Keystone, and then place the Keystone's QR code in front of your camera."]},void 0),(0,n.jsxs)(r.Z,{children:[1===g&&(0,n.jsxs)(h.Z,Object.assign({sx:{display:"flex"}},{children:[(0,n.jsx)(V,{step:1,message:JSON.stringify(e)},void 0),(0,n.jsx)(ee,{step:1,onComplete:t=>(0,o.mG)(void 0,void 0,void 0,(function*(){console.log("step1 end"),console.log("message1",e.message1),v(!0);const n=yield function(e){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.signTransactionStep1,params:{message2:e}})}))}(t);v(!1),console.log(n),n.success&&n.message3?(x(n.message3),m(2)):(s(),j(n.errMsg))}))},void 0)]}),void 0),2===g&&(0,n.jsxs)(h.Z,Object.assign({sx:{display:"flex"}},{children:[(0,n.jsx)(V,{step:2,message:u},void 0),(0,n.jsx)(ee,{step:2,onComplete:e=>(0,o.mG)(void 0,void 0,void 0,(function*(){console.log("step2 end"),console.log("message3",u),v(!0);const n=yield function(e){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.signTransactionStep2,params:{message4:e}})}))}(e);console.log(n),v(!1),n.success?t(`${n.signedRawTransaction}`):(s(),j(n.errMsg))}))},void 0)]}),void 0)]},void 0),(0,n.jsx)(d.Z,{children:(0,n.jsx)(l.Z,Object.assign({variant:"outlined",onClick:s},{children:"Cancel"}),void 0)},void 0)]}),void 0)};var Ce=({txObj:e,onClose:s,onComplete:t})=>{var o;const[i,v]=(0,c.useState)(`${e.nonce}`),[u,x]=(0,c.useState)(`${null===(o=e.gasLimit)||void 0===o?void 0:o.toString()}`),[g,m]=(0,c.useState)(e.maxFeePerGas),[j,p]=(0,c.useState)(e.maxPriorityFeePerGas),[f,b]=(0,c.useState)({}),Z=(0,c.useCallback)((e=>{e.target.value&&/^[+]{0,1}(\d+)$/.test(e.target.value)?b({error:!1,text:""}):b({error:!0,text:"Nonce must be a positive integer"}),v(e.target.value)}),[v]),y=(0,c.useCallback)((e=>{x(e.target.value)}),[x]),C=(0,c.useCallback)((e=>{m(e.target.value)}),[m]),S=(0,c.useCallback)((e=>{p(e.target.value)}),[p]);return(0,n.jsxs)(a.Z,Object.assign({open:!0,maxWidth:"sm"},{children:[(0,n.jsxs)(R.Z,{children:["Confirm Data",(0,n.jsx)(M.Z,Object.assign({"aria-label":"close",onClick:s,sx:{position:"absolute",right:8,top:8,color:e=>e.palette.grey[500]}},{children:(0,n.jsx)(W.Z,{},void 0)}),void 0)]},void 0),(0,n.jsx)(r.Z,{children:(0,n.jsxs)(h.Z,Object.assign({sx:{display:"flex",flexDirection:"column"}},{children:[(0,n.jsxs)(h.Z,{children:["to: ",e.to]},void 0),(0,n.jsxs)(h.Z,{children:[" amount: ",e.value," ETH"]},void 0),(0,n.jsx)(ie.Z,{label:"Nonce",value:i,sx:{m:1,width:"40ch"},onChange:Z,error:f.error,helperText:f.text},void 0),(0,n.jsx)(ie.Z,{label:"Gas Limit",value:u,sx:{m:1,width:"40ch"},onChange:y},void 0),(0,n.jsx)(ie.Z,{label:"Max Base Fee",value:g,sx:{m:1,width:"40ch"},InputProps:{endAdornment:(0,n.jsx)(be.Z,Object.assign({position:"start"},{children:"GWei"}),void 0)},onChange:C},void 0),(0,n.jsx)(ie.Z,{label:"Priority",value:j,sx:{m:1,width:"40ch"},InputProps:{endAdornment:(0,n.jsx)(be.Z,Object.assign({position:"start"},{children:"GWei"}),void 0)},onChange:S},void 0)]}),void 0)},void 0),(0,n.jsx)(d.Z,Object.assign({sx:{padding:2}},{children:(0,n.jsx)(l.Z,Object.assign({variant:"contained",onClick:()=>{console.log(e);const o=Object.assign(Object.assign({},e),{nonce:parseInt(i),gasLimit:u,maxFeePerGas:`${g}`,maxPriorityFeePerGas:`${j}`});console.log(o),s(),t(o)}},{children:"Confirm"}),void 0)}),void 0)]}),void 0)};var Se=({address:e,network:s,onComplete:t,startHeartBeat:i,stopHeartBeat:a})=>{const r=b(),[d,v]=(0,c.useState)(!1),[u,x]=(0,c.useState)(!1),[g,m]=(0,c.useState)(!1),[j,f]=(0,c.useState)(""),[Z,y]=(0,c.useState)(""),[C,S]=(0,c.useState)(""),[k,P]=(0,c.useState)({}),[H,W]=(0,c.useState)({}),R=(0,c.useCallback)((e=>{f(e.target.value)}),[f]),M=(0,c.useCallback)((e=>{y(e.target.value)}),[y]),F=(0,c.useCallback)((e=>{S(e.target.value)}),[S]),T=e=>(0,o.mG)(void 0,void 0,void 0,(function*(){if(a(),U)try{v(!0);const s=yield U.sendTransaction(e);if(v(!1),"error"in s)return console.log(s),void r("Failed");console.log("txhash",s.hash),t(s.hash);const o=yield s.wait();console.log(o)}catch(e){v(!1),r(e.error.message)}}));return(0,n.jsxs)(w.Z,Object.assign({variant:"outlined"},{children:[(0,n.jsx)(p,{loading:d},void 0),(0,n.jsx)(O.Z,{title:"Send"},void 0),(0,n.jsxs)(I.Z,{children:[(0,n.jsxs)(G.ZP,Object.assign({container:!0,spacing:2,direction:"row",alignItems:"center",justifyContent:"space-between"},{children:[(0,n.jsxs)(G.ZP,Object.assign({item:!0,xs:6},{children:[(0,n.jsx)(ie.Z,{size:"medium",fullWidth:!0,id:"to",label:"To",variant:"outlined",value:j,onChange:R},void 0),(0,n.jsx)(h.Z,{m:"20px"},void 0),(0,n.jsx)(ie.Z,{size:"medium",fullWidth:!0,id:"amount",label:"Amount",variant:"outlined",value:Z,onChange:M,InputProps:{endAdornment:(0,n.jsx)(be.Z,Object.assign({position:"start"},{children:"ETH"}),void 0)}},void 0)]}),void 0),(0,n.jsx)(G.ZP,Object.assign({item:!0,xs:6},{children:(0,n.jsx)(ie.Z,{size:"medium",rows:4,multiline:!0,fullWidth:!0,id:"data",label:"Hex Data",variant:"outlined",value:C,onChange:F},void 0)}),void 0)]}),void 0),(0,n.jsx)(h.Z,{m:"20px"},void 0)]},void 0),(0,n.jsx)(Ze.Z,Object.assign({sx:{padding:2}},{children:(0,n.jsx)(l.Z,Object.assign({variant:"contained",size:"small",onClick:()=>(0,o.mG)(void 0,void 0,void 0,(function*(){var s;if(U)try{const t={to:j,value:D.utils.parseUnits(Z,18).toHexString(),data:(s=C,s?K.isHexString(s)?s:K.hexlify(N.Y0(s)):"")};v(!0);const o=yield U.getTransactionCount(e),n=(yield U.getNetwork()).chainId,i=yield U.getFeeData(),a=(yield U.estimateGas(t)).toString(),r=D.utils.formatUnits(i.maxFeePerGas,"gwei"),d=D.utils.formatUnits(i.maxPriorityFeePerGas,"gwei");P({nonce:o,to:j,value:Z,data:C,chainId:n,maxFeePerGas:r,maxPriorityFeePerGas:d,gasLimit:a}),v(!1),x(!0)}catch(e){console.log(e),v(!1),r("Please check address")}}))},{children:"Send Transaction"}),void 0)}),void 0),u&&(0,n.jsx)(Ce,{txObj:k,onClose:()=>x(!1),onComplete:e=>(0,o.mG)(void 0,void 0,void 0,(function*(){i(),v(!0);const t=yield function(e){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.signTransactionContext,params:{transactionObject:e}})}))}(e);v(!1),t.success&&t.message1?(W({message1:t.message1,txObj:e,networkName:s.name}),m(!0)):(r(t.errMsg),a())}))},void 0),g&&(0,n.jsx)(ye,{onClose:()=>{a(),m(!1)},onComplete:e=>{m(!1),console.log("signedRawTransaction",e),T(e)},qrcode1:H},void 0)]}),void 0)};var we=()=>{const[e,s]=(0,c.useState)(!0),t=()=>(0,o.mG)(void 0,void 0,void 0,(function*(){const e=yield function(){return(0,o.mG)(this,void 0,void 0,(function*(){try{return!(!window.ethereum||!window.ethereum.isMetaMask||(yield window.ethereum.request({method:"wallet_getSnaps"}),0))}catch(e){return!1}}))}();s(e)}));return(0,c.useEffect)((()=>{t()}),[]),(0,n.jsxs)(h.Z,Object.assign({sx:{display:"flex",flexDirection:"column",alignItems:"center",paddingTop:10}},{children:[(0,n.jsx)("img",{src:"../assets/welcome.png",width:"100%"},void 0),!e&&(0,n.jsxs)("p",{children:["Please ensure you have MetaMask Flask Installed for this example, Click",(0,n.jsxs)("a",Object.assign({target:"_blank",href:"https://metamask.io/flask/"},{children:[" ","here"]}),void 0)," ","to install"]},void 0),(0,n.jsx)("p",{children:"This site is for demonstration purposes only, please do not use it in a production environment."},void 0)]}),void 0)};const Oe="x-connected",ke="x-address";var Ie={get(e,s=!1){const t=localStorage.getItem(e);return t&&s?JSON.parse(t):t},set(e,s,t=!1){let o="";t&&(o=JSON.stringify(s)),localStorage.setItem(e,s)}};const{ethereum:Ge}=window;var Pe=()=>{const e=(0,c.useRef)(null),s=b(),[t,i]=(0,c.useState)(!1),[a,r]=(0,c.useState)(!1),[d,l]=(0,c.useState)(sessionStorage.getItem(ke)||""),[m,j]=(0,c.useState)(!1),[f,Z]=(0,c.useState)({}),[y,C]=(0,c.useState)(""),[S,w]=(0,c.useState)([]),[O,k]=(0,c.useState)(!1),[I,G]=(0,c.useState)(!1),[P,H]=(0,c.useState)(!1),W=(0,c.useRef)(),R=(0,c.useRef)();(0,c.useEffect)((()=>(M(),()=>{clearInterval(W.current),clearInterval(R.current)})),[]);const M=()=>(0,o.mG)(void 0,void 0,void 0,(function*(){if(yield X())return sessionStorage.getItem(Oe)?(i(!0),F(),void L()):void 0})),F=()=>(0,o.mG)(void 0,void 0,void 0,(function*(){console.log("getData");const e=yield Promise.all([q(),N()]);K(e),T()})),T=()=>(0,o.mG)(void 0,void 0,void 0,(function*(){const e=yield function(){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.queryBackupStatus})}))}();e.success&&(console.log("backuped",e.backuped),j(e.backuped))})),E=([e,s])=>`x-tx-${s}-${e}`,K=([e,s])=>{var t;const o=null!==(t=Ie.get(E([e,s]),!0))&&void 0!==t?t:[];w(o)},N=()=>(0,o.mG)(void 0,void 0,void 0,(function*(){var e;if(!Ge)return;Ge.on("chainChanged",(e=>{window.location.reload()}));const s=yield Ge.request({method:"eth_chainId"});try{const t=(yield D.utils.fetchJson("https://chainid.network/chains.json")).find((e=>e.chainId===parseInt(s)));return console.log(t),Z({name:t.title||t.name,chainId:s,explorer:t.explorers.length?null===(e=t.explorers[0])||void 0===e?void 0:e.url:null}),s}catch(e){return console.log(e),s}})),q=()=>(0,o.mG)(void 0,void 0,void 0,(function*(){const e=sessionStorage.getItem(ke);if(e)return console.log("cachedAddress"),l(e),J(e),e;{const e=yield function(){return(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.requestAccount})}))}();return console.log(e),e.success&&e.address?(l(e.address),sessionStorage.setItem(ke,e.address),J(e.address),e.address):""}})),J=e=>(0,o.mG)(void 0,void 0,void 0,(function*(){if(!U)return;if(!d)return;const s=yield U.getBalance(e);console.log("getBalance",s.toString()),C(s.toString())})),L=()=>{clearInterval(W.current),W.current=setInterval((()=>{J(d)}),3e4)},V=()=>{Y(),R.current=setInterval((()=>{!function(){(0,o.mG)(this,void 0,void 0,(function*(){return A({method:z.Hl.heartBeat})}))}()}),2e4)},Y=()=>{clearInterval(R.current)},X=()=>(0,o.mG)(void 0,void 0,void 0,(function*(){if(!Ge)return!1;return(yield Ge.request({method:"web3_clientVersion"})).includes("flask")}));return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(p,{loading:a},void 0),!!d&&!m&&(0,n.jsxs)(u.Z,Object.assign({severity:"warning"},{children:["Important! MPC Wallet not backed up! Click"," ",(0,n.jsx)(x.Z,Object.assign({sx:{cursor:"pointer",textDecoration:"none"},onClick:()=>H(!0)},{children:"here"}),void 0)," ","to back up."]}),void 0),(0,n.jsxs)(g.Z,Object.assign({fixed:!0,style:{paddingTop:20}},{children:[(0,n.jsx)(le,{connected:t,onConnect:()=>(0,o.mG)(void 0,void 0,void 0,(function*(){(yield X())&&(r(!0),function(e){(0,o.mG)(this,void 0,void 0,(function*(){console.log("connect...");try{const s=yield null==$?void 0:$.request({method:"wallet_enable",params:[{wallet_snap:{[B]:{}}}]});if(s){const t=s.snaps[B];console.log(t),t.error?e({success:!1,message:t.error.message}):e({success:!0})}}catch(s){e({success:!1,message:s.message})}}))}((({success:e,message:t})=>{r(!1),e?(i(!0),sessionStorage.setItem(Oe,"true"),F(),L()):s(t)})))}))},void 0),t?(0,n.jsxs)("div",{children:[(0,n.jsxs)(h.Z,Object.assign({sx:{padding:"30px 0"}},{children:[(0,n.jsx)(_,{network:f,address:d,balance:y,onDelete:()=>{sessionStorage.setItem(ke,""),l("")},onExport:()=>H(!0)},void 0),(0,n.jsx)(h.Z,{m:"20px"},void 0),(0,n.jsx)(Se,{network:f,address:d,onComplete:s=>{var t,o;Y();const n=E([d,f.chainId]),i=[...null!==(t=Ie.get(n,!0))&&void 0!==t?t:[],{txHash:s}];w(i),Ie.set(n,JSON.stringify(i),!0),null===(o=e.current)||void 0===o||o.open("Success!")},startHeartBeat:V,stopHeartBeat:Y},void 0)]}),void 0),(0,n.jsx)(fe,{list:S,explorer:f.explorer},void 0),(0,n.jsx)(h.Z,{m:"20px"},void 0),!d&&(0,n.jsx)(Q,{onCreate:()=>{k(!0)},onImport:()=>{G(!0)},startHeartBeat:V,stopHeartBeat:Y},void 0),I&&(0,n.jsx)(ve,{onClose:()=>G(!1),onComplete:e=>{G(!1),l(e),sessionStorage.setItem(ke,e),J(e),j(!0)}},void 0),P&&(0,n.jsx)(de,{onClose:()=>H(!1),onComplete:()=>{j(!0)}},void 0),O&&(0,n.jsx)(te,{onClose:()=>{Y(),k(!1)},onComplete:s=>{var t;Y(),sessionStorage.setItem(ke,s),l(s),k(!1),L(),null===(t=e.current)||void 0===t||t.open("Wallet Created!")}},void 0)]},void 0):(0,n.jsx)(we,{},void 0),(0,n.jsx)(v,{ref:e},void 0)]}),void 0)]},void 0)}},11164:function(){}}]);